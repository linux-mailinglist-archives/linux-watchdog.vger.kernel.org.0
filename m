Return-Path: <linux-watchdog-owner@vger.kernel.org>
X-Original-To: lists+linux-watchdog@lfdr.de
Delivered-To: lists+linux-watchdog@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 7C37120346E
	for <lists+linux-watchdog@lfdr.de>; Mon, 22 Jun 2020 12:03:44 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1728129AbgFVKDl (ORCPT <rfc822;lists+linux-watchdog@lfdr.de>);
        Mon, 22 Jun 2020 06:03:41 -0400
Received: from mail-eopbgr1320044.outbound.protection.outlook.com ([40.107.132.44]:38144
        "EHLO APC01-PU1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1726942AbgFVKDk (ORCPT <rfc822;linux-watchdog@vger.kernel.org>);
        Mon, 22 Jun 2020 06:03:40 -0400
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=P+cjCkZ9C03a3nk/acH//PAwS7khvGipZrLrlFat3HTj52iH8xDTAMZH/gDtoQV7gThtZ7G893Jl904R0fEVezsSMlU+CwA8vRWV42vw2n4O0g58cNgFNDnzB+bO3z5kaOT3X+6uhIALHjm3XXePoLtacOc8qUm0qxZojiT+XpCt4VYxgsAIw8fsYJrJ8oeiHAeh5kARAw8cPdUpKWxVPTNcQyNGRu1XoAKHxZaMCEKqh+sGrYKvJNiPkZGFv+DK/8QjvYLxhDagBDk5AyQM+f7vYn4rVRzVlYibw61VkkrgMwtduEhmj8W+ws3YLPewzyGP59Hi+zf7MS4KVJ8o/g==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=C7Yow9m3wuoT3s2vPHaij8M5L7pJY583nocBG7pru5U=;
 b=RMeUL4TA37IdsTv07qMZ3JjnbUj0MXvLEmPKJgQ1XyeaFoYcM67T3HV/rHgwZUtcSTIi5Z14b1q3WHZ4rhkm4PtpMED6z0jWpXrU2Fn03Y0F8T3Ag+bhqLy52qO12k6v6xXY/jvymfJDrqUF7H9njNXvPEunaBPWXLOc7RkWq6zQzhxHXevJ0CfLg0zRGeqAP+o//rHqBALLW6JPuuEtDYyujL31p8Z63igv9MnsDsntuaGPKbE+ELv2NdJzkBbXALtGdb7WjW+5nsCGjd/zBa2F+I1dAZvi79Vm9IkiPVRzM4mDMavI/4HCip59lJY5IxnqA1eioyOFlB8d2cOWJQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=moxa.com; dmarc=pass action=none header.from=moxa.com;
 dkim=pass header.d=moxa.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=moxa.com; s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=C7Yow9m3wuoT3s2vPHaij8M5L7pJY583nocBG7pru5U=;
 b=JlkvBRBBdUBYY5DDSj8imlfuVn5Wzbnhd3O4p0FbFOctOB/5alnHXt7cVTZd2JQAnxYbmtkVKXnQxttck1AVYngnHbB4lEYBb3cBTnHAxKCThpMAM7z5+pnkGxlDpRSHREGy3pAS3JDYgcbIYG31rilCH/Jim/rmGJ13Qsda5uI=
Received: from HK2PR01MB3281.apcprd01.prod.exchangelabs.com
 (2603:1096:202:22::12) by HK2PR01MB3217.apcprd01.prod.exchangelabs.com
 (2603:1096:202:24::19) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3109.22; Mon, 22 Jun
 2020 10:03:30 +0000
Received: from HK2PR01MB3281.apcprd01.prod.exchangelabs.com
 ([fe80::712b:170d:f873:68a3]) by HK2PR01MB3281.apcprd01.prod.exchangelabs.com
 ([fe80::712b:170d:f873:68a3%6]) with mapi id 15.20.3109.027; Mon, 22 Jun 2020
 10:03:29 +0000
From:   =?big5?B?Sm9obnNvbiBDSCBDaGVuICizr6xMvrEp?= 
        <JohnsonCH.Chen@moxa.com>
To:     "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>
CC:     "linux-rtc@vger.kernel.org" <linux-rtc@vger.kernel.org>,
        "linux-watchdog@vger.kernel.org" <linux-watchdog@vger.kernel.org>,
        Alessandro Zummo <a.zummo@towertech.it>,
        Alexandre Belloni <alexandre.belloni@bootlin.com>,
        Wim Van Sebroeck <wim@linux-watchdog.org>,
        "linux@roeck-us.net" <linux@roeck-us.net>,
        Lee Jones <lee.jones@linaro.org>
Subject: [PATCH 2/3] rtc: rtc-ds1374: Move out Watchdog function and I2C
  client
Thread-Topic: [PATCH 2/3] rtc: rtc-ds1374: Move out Watchdog function and I2C
  client
Thread-Index: AQHWSHmg3EA8AI+Xik+Rhl82TcLPCA==
Date:   Mon, 22 Jun 2020 10:03:28 +0000
Message-ID: <HK2PR01MB32816212BE9A64531A6032CCFA970@HK2PR01MB3281.apcprd01.prod.exchangelabs.com>
Accept-Language: zh-TW, en-US
Content-Language: zh-TW
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: vger.kernel.org; dkim=none (message not signed)
 header.d=none;vger.kernel.org; dmarc=none action=none header.from=moxa.com;
x-originating-ip: [123.51.145.16]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 180a7668-0019-429c-1abf-08d81693834b
x-ms-traffictypediagnostic: HK2PR01MB3217:
x-microsoft-antispam-prvs: <HK2PR01MB32177DC32B44331311794FE9FA970@HK2PR01MB3217.apcprd01.prod.exchangelabs.com>
x-ms-oob-tlc-oobclassifiers: OLM:5236;
x-forefront-prvs: 0442E569BC
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: YsvzzVsrlg/v1BYXcK4NsXKDV110BKYZDDMHV6rAV24PptQ8vJCPzAOdD4V2YBPD0LYyI9ojEIgv6b2i/XsZ6pqHD1t47iW3GY4v6gmrZbsQutAcJSlDX5c4Wcdi/qEpujR/yErRN9CfBErfuIwLk7orc3+TytwXc4lyx+HIGePptrLLj+sq2OlQronE2s3tYK95SKxzowJ8rCeNmgDjwKd8sqB/5AnibAJ8j1ILnV9J2G4Vo3ag+78yhrSofpLFpS+sHsrypO5Ae2klb1NsVlq2fM5p9vVltlmEm8vZbhThvbxUDJD670ASINHi3/IoqNnhu3B0T9npLGnkT6dxWQ==
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:HK2PR01MB3281.apcprd01.prod.exchangelabs.com;PTR:;CAT:NONE;SFTY:;SFS:(4636009)(136003)(366004)(346002)(396003)(376002)(39850400004)(186003)(85182001)(6506007)(26005)(8936002)(6916009)(7696005)(8676002)(71200400001)(4326008)(83380400001)(316002)(2906002)(86362001)(30864003)(33656002)(52536014)(9686003)(66946007)(76116006)(64756008)(55016002)(54906003)(5660300002)(478600001)(66446008)(66556008)(66476007);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata: eUu/862zdh2F/rdMoQAmMDdBkrVu5mwW7eglLJILu2GdMgDQW+4kkdoDRZCKYBhjc1Y+LxJk1dgd5LesmkaKsRS66XrjJMCdKf6up3sjEJ7Z4b73jIMP1VUIww2rkES6vA9Pqnz/1Ol1uXYspNIA5mqtGwMtpplPrR0s6zAfjD83d7SCwyaAHA8jpXdliVRhuCOR6zS7lblHglKMyeFSDS86NGszWFPUPX4g1wagVQjawgvwABko0IXzQvtaVWmNIDRT3kArMhzKhGymw7CZDQ53Tu1k2KkY5lSNAgsAM+kSr/FUcKL8Hbuu6EdRvIABsk5+X01wS7Da5zAVnId5l495xtpYwwHfCdmKigdc4iHd9RYslrVMlnIKVl6b7KibQ8tdvgDvzgivZlW7vcc+2Kkq36aJmqlXW+tptjwhPe19KMnFrdh27ok/QG+Eox8VCF/nRqAo+Au4mk38JSB7G0fBgmEaXb0GCEV6vcsMi2A=
x-ms-exchange-transport-forked: True
Content-Type: text/plain; charset="big5"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: moxa.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 180a7668-0019-429c-1abf-08d81693834b
X-MS-Exchange-CrossTenant-originalarrivaltime: 22 Jun 2020 10:03:28.9677
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 5571c7d4-286b-47f6-9dd5-0aa688773c8e
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 0gKfKWv6DHgTfMbqsmcDJsHac1hgzPtO5K/YstJjz0Aduyds/z9GN6Mk7gaj2+2tEZRSvJwhGNytW8eiREiDZA==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: HK2PR01MB3217
Sender: linux-watchdog-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-watchdog.vger.kernel.org>
X-Mailing-List: linux-watchdog@vger.kernel.org

TW92ZSBXYXRjaGRvZyBmdW5jdGlvbiB0byBkczEzNzRfd2R0LmMgd2hpY2ggaXMgaW4gdGhlIFdh
dGNoZG9nCnN1YnN5c3RlbSwgYW5kIGp1c3Qga2VlcCBSVEMgYW5kIEFsYXJtIGZ1bmN0aW9uIGlu
IHJ0Yy1kczEzNzQuYy4KCkJlc2lkZXMsIE1vdmUgSTJDIGNsaWVudCB0byBkczEzNzQuYyB3aGlj
aCBpcyBpbiBNRkQgc3Vic3lzdGVtLgoKU2lnbmVkLW9mZi1ieTogSm9obnNvbiBDaGVuIDxqb2hu
c29uY2guY2hlbkBtb3hhLmNvbT4KLS0tCiBkcml2ZXJzL3J0Yy9LY29uZmlnICAgICAgfCAgIDkg
Ky0KIGRyaXZlcnMvcnRjL3J0Yy1kczEzNzQuYyB8IDQ1OCArKysrKysrLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgNzYgaW5zZXJ0aW9ucygrKSwgMzkx
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvcnRjL0tjb25maWcgYi9kcml2ZXJz
L3J0Yy9LY29uZmlnCmluZGV4IGVjODczZjA5Yzc2My4uY2MwMjBmYjdhMmE5IDEwMDY0NAotLS0g
YS9kcml2ZXJzL3J0Yy9LY29uZmlnCisrKyBiL2RyaXZlcnMvcnRjL0tjb25maWcKQEAgLTI3MSw2
ICsyNzEsOCBAQCBjb25maWcgUlRDX0RSVl9EUzEzMDdfQ0VOVFVSWQogCiBjb25maWcgUlRDX0RS
Vl9EUzEzNzQKIAl0cmlzdGF0ZSAiRGFsbGFzL01heGltIERTMTM3NCIKKwlkZXBlbmRzIG9uIE1G
RF9EUzEzNzQKKwogCWhlbHAKIAkgIElmIHlvdSBzYXkgeWVzIGhlcmUgeW91IGdldCBzdXBwb3J0
IGZvciBEYWxsYXMgU2VtaWNvbmR1Y3RvcgogCSAgRFMxMzc0IHJlYWwtdGltZSBjbG9jayBjaGlw
cy4gSWYgYW4gaW50ZXJydXB0IGlzIGFzc29jaWF0ZWQKQEAgLTI3OSwxMyArMjgxLDYgQEAgY29u
ZmlnIFJUQ19EUlZfRFMxMzc0CiAJICBUaGlzIGRyaXZlciBjYW4gYWxzbyBiZSBidWlsdCBhcyBh
IG1vZHVsZS4gSWYgc28sIHRoZSBtb2R1bGUKIAkgIHdpbGwgYmUgY2FsbGVkIHJ0Yy1kczEzNzQu
CiAKLWNvbmZpZyBSVENfRFJWX0RTMTM3NF9XRFQKLQlib29sICJEYWxsYXMvTWF4aW0gRFMxMzc0
IHdhdGNoZG9nIHRpbWVyIgotCWRlcGVuZHMgb24gUlRDX0RSVl9EUzEzNzQKLQloZWxwCi0JICBJ
ZiB5b3Ugc2F5IFkgaGVyZSB5b3Ugd2lsbCBnZXQgc3VwcG9ydCBmb3IgdGhlCi0JICB3YXRjaGRv
ZyB0aW1lciBpbiB0aGUgRGFsbGFzIFNlbWljb25kdWN0b3IgRFMxMzc0Ci0JICByZWFsLXRpbWUg
Y2xvY2sgY2hpcHMuCiAKIGNvbmZpZyBSVENfRFJWX0RTMTY3MgogCXRyaXN0YXRlICJEYWxsYXMv
TWF4aW0gRFMxNjcyIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ydGMvcnRjLWRzMTM3NC5jIGIvZHJp
dmVycy9ydGMvcnRjLWRzMTM3NC5jCmluZGV4IDljNTFhMTJjZjcwZi4uZDhmZjBmYmJhNTJjIDEw
MDY0NAotLS0gYS9kcml2ZXJzL3J0Yy9ydGMtZHMxMzc0LmMKKysrIGIvZHJpdmVycy9ydGMvcnRj
LWRzMTM3NC5jCkBAIC0xLDE3ICsxLDE2IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMAogLyoKICAqIFJUQyBjbGllbnQvZHJpdmVyIGZvciB0aGUgTWF4aW0vRGFsbGFzIERT
MTM3NCBSZWFsLVRpbWUgQ2xvY2sgb3ZlciBJMkMKICAqCiAgKiBCYXNlZCBvbiBjb2RlIGJ5IFJh
bmR5IFZpbnNvbiA8cnZpbnNvbkBtdmlzdGEuY29tPiwKICAqIHdoaWNoIHdhcyBiYXNlZCBvbiB0
aGUgbTQxdDAwLmMgYnkgTWFyayBHcmVlciA8bWdyZWVyQG12aXN0YS5jb20+LgogICoKKyAqIENv
cHlyaWdodCAoQykgMjAyMCBKb2huc29uIENoZW4gPGpvaG5zb25jaC5jaGVuQG1veGEuY29tPgog
ICogQ29weXJpZ2h0IChDKSAyMDE0IFJvc2UgVGVjaG5vbG9neQogICogQ29weXJpZ2h0IChDKSAy
MDA2LTIwMDcgRnJlZXNjYWxlIFNlbWljb25kdWN0b3IKLSAqCi0gKiAyMDA1IChjKSBNb250YVZp
c3RhIFNvZnR3YXJlLCBJbmMuIFRoaXMgZmlsZSBpcyBsaWNlbnNlZCB1bmRlcgotICogdGhlIHRl
cm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIuIFRoaXMgcHJv
Z3JhbQotICogaXMgbGljZW5zZWQgImFzIGlzIiB3aXRob3V0IGFueSB3YXJyYW50eSBvZiBhbnkg
a2luZCwgd2hldGhlciBleHByZXNzCi0gKiBvciBpbXBsaWVkLgorICogQ29weXJpZ2h0IChDKSAy
MDA1IE1vbnRhVmlzdGEgU29mdHdhcmUsIEluYy4KICAqLworCiAvKgogICogSXQgd291bGQgYmUg
bW9yZSBlZmZpY2llbnQgdG8gdXNlIGkyYyBtc2dzL2kyY190cmFuc2ZlciBkaXJlY3RseSBidXQs
IGFzCiAgKiByZWNvbW1lbmRlZCBpbiAuLi4vRG9jdW1lbnRhdGlvbi9pMmMvd3JpdGluZy1jbGll
bnRzLnJzdCBzZWN0aW9uCkBAIC0yNSwxNyArMjQsMTAgQEAKICNpbmNsdWRlIDxsaW51eC9pbnRl
cnJ1cHQuaD4KICNpbmNsdWRlIDxsaW51eC9pMmMuaD4KICNpbmNsdWRlIDxsaW51eC9ydGMuaD4K
LSNpbmNsdWRlIDxsaW51eC9iY2QuaD4KICNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KLSNp
bmNsdWRlIDxsaW51eC9zbGFiLmg+Ci0jaW5jbHVkZSA8bGludXgvcG0uaD4KLSNpZmRlZiBDT05G
SUdfUlRDX0RSVl9EUzEzNzRfV0RUCi0jaW5jbHVkZSA8bGludXgvZnMuaD4KLSNpbmNsdWRlIDxs
aW51eC9pb2N0bC5oPgotI2luY2x1ZGUgPGxpbnV4L21pc2NkZXZpY2UuaD4KLSNpbmNsdWRlIDxs
aW51eC9yZWJvb3QuaD4KLSNpbmNsdWRlIDxsaW51eC93YXRjaGRvZy5oPgotI2VuZGlmCisjaW5j
bHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CisKKyNkZWZpbmUgREVWTkFNRSAiZHMxMzc0
X3J0YyIKIAogI2RlZmluZSBEUzEzNzRfUkVHX1RPRDAJCTB4MDAgLyogVGltZSBvZiBEYXkgKi8K
ICNkZWZpbmUgRFMxMzc0X1JFR19UT0QxCQkweDAxCkBAIC01MywyMSArNDUsNyBAQAogI2RlZmlu
ZSBEUzEzNzRfUkVHX1NSX0FGCTB4MDEgLyogQWxhcm0gRmxhZyAqLwogI2RlZmluZSBEUzEzNzRf
UkVHX1RDUgkJMHgwOSAvKiBUcmlja2xlIENoYXJnZSAqLwogCi1zdGF0aWMgY29uc3Qgc3RydWN0
IGkyY19kZXZpY2VfaWQgZHMxMzc0X2lkW10gPSB7Ci0JeyAiZHMxMzc0IiwgMCB9LAotCXsgfQot
fTsKLU1PRFVMRV9ERVZJQ0VfVEFCTEUoaTJjLCBkczEzNzRfaWQpOwotCi0jaWZkZWYgQ09ORklH
X09GCi1zdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCBkczEzNzRfb2ZfbWF0Y2hbXSA9
IHsKLQl7IC5jb21wYXRpYmxlID0gImRhbGxhcyxkczEzNzQiIH0sCi0JeyB9Ci19OwotTU9EVUxF
X0RFVklDRV9UQUJMRShvZiwgZHMxMzc0X29mX21hdGNoKTsKLSNlbmRpZgotCi1zdHJ1Y3QgZHMx
Mzc0IHsKK3N0cnVjdCBkczEzNzRfcnRjIHsKIAlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50Owog
CXN0cnVjdCBydGNfZGV2aWNlICpydGM7CiAJc3RydWN0IHdvcmtfc3RydWN0IHdvcms7CkBAIC04
MCw4ICs1OCw2IEBAIHN0cnVjdCBkczEzNzQgewogCWludCBleGl0aW5nOwogfTsKIAotc3RhdGlj
IHN0cnVjdCBpMmNfZHJpdmVyIGRzMTM3NF9kcml2ZXI7Ci0KIHN0YXRpYyBpbnQgZHMxMzc0X3Jl
YWRfcnRjKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIHUzMiAqdGltZSwKIAkJCSAgIGludCBy
ZWcsIGludCBuYnl0ZXMpCiB7CkBAIC0xNTgsNyArMTM0LDcgQEAgc3RhdGljIGludCBkczEzNzRf
Y2hlY2tfcnRjX3N0YXR1cyhzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50KQogCiBzdGF0aWMgaW50
IGRzMTM3NF9yZWFkX3RpbWUoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgcnRjX3RpbWUgKnRp
bWUpCiB7Ci0Jc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCA9IHRvX2kyY19jbGllbnQoZGV2KTsK
KwlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0gdG9faTJjX2NsaWVudChkZXYtPnBhcmVudCk7
CiAJdTMyIGl0aW1lOwogCWludCByZXQ7CiAKQEAgLTE3MSwyMSArMTQ3LDIxIEBAIHN0YXRpYyBp
bnQgZHMxMzc0X3JlYWRfdGltZShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBydGNfdGltZSAq
dGltZSkKIAogc3RhdGljIGludCBkczEzNzRfc2V0X3RpbWUoc3RydWN0IGRldmljZSAqZGV2LCBz
dHJ1Y3QgcnRjX3RpbWUgKnRpbWUpCiB7Ci0Jc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCA9IHRv
X2kyY19jbGllbnQoZGV2KTsKKwlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0gdG9faTJjX2Ns
aWVudChkZXYtPnBhcmVudCk7CiAJdW5zaWduZWQgbG9uZyBpdGltZSA9IHJ0Y190bV90b190aW1l
NjQodGltZSk7CiAKIAlyZXR1cm4gZHMxMzc0X3dyaXRlX3J0YyhjbGllbnQsIGl0aW1lLCBEUzEz
NzRfUkVHX1RPRDAsIDQpOwogfQogCi0jaWZuZGVmIENPTkZJR19SVENfRFJWX0RTMTM3NF9XRFQK
KyNpZm5kZWYgQ09ORklHX0RTMTM3NF9XQVRDSERPRwogLyogVGhlIGRzMTM3NCBoYXMgYSBkZWNy
ZW1lbnRlciBmb3IgYW4gYWxhcm0sIHJhdGhlciB0aGFuIGEgY29tcGFyYXRvci4KICAqIElmIHRo
ZSB0aW1lIG9mIGRheSBpcyBjaGFuZ2VkLCB0aGVuIHRoZSBhbGFybSB3aWxsIG5lZWQgdG8gYmUK
ICAqIHJlc2V0LgogICovCiBzdGF0aWMgaW50IGRzMTM3NF9yZWFkX2FsYXJtKHN0cnVjdCBkZXZp
Y2UgKmRldiwgc3RydWN0IHJ0Y193a2Fscm0gKmFsYXJtKQogewotCXN0cnVjdCBpMmNfY2xpZW50
ICpjbGllbnQgPSB0b19pMmNfY2xpZW50KGRldik7Ci0Jc3RydWN0IGRzMTM3NCAqZHMxMzc0ID0g
aTJjX2dldF9jbGllbnRkYXRhKGNsaWVudCk7CisJc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCA9
IHRvX2kyY19jbGllbnQoZGV2LT5wYXJlbnQpOworCXN0cnVjdCBkczEzNzRfcnRjICpkcnZfZGF0
YSA9IGRldi0+ZHJpdmVyX2RhdGE7CiAJdTMyIG5vdywgY3VyX2FsYXJtOwogCWludCBjciwgc3I7
CiAJaW50IHJldCA9IDA7CkBAIC0xOTMsNyArMTY5LDcgQEAgc3RhdGljIGludCBkczEzNzRfcmVh
ZF9hbGFybShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBydGNfd2thbHJtICphbGFybSkKIAlp
ZiAoY2xpZW50LT5pcnEgPD0gMCkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKLQltdXRleF9sb2NrKCZk
czEzNzQtPm11dGV4KTsKKwltdXRleF9sb2NrKCZkcnZfZGF0YS0+bXV0ZXgpOwogCiAJY3IgPSBy
ZXQgPSBpMmNfc21idXNfcmVhZF9ieXRlX2RhdGEoY2xpZW50LCBEUzEzNzRfUkVHX0NSKTsKIAlp
ZiAocmV0IDwgMCkKQEAgLTIxNiwxNCArMTkyLDE0IEBAIHN0YXRpYyBpbnQgZHMxMzc0X3JlYWRf
YWxhcm0oc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgcnRjX3drYWxybSAqYWxhcm0pCiAJYWxh
cm0tPnBlbmRpbmcgPSAhIShzciAmIERTMTM3NF9SRUdfU1JfQUYpOwogCiBvdXQ6Ci0JbXV0ZXhf
dW5sb2NrKCZkczEzNzQtPm11dGV4KTsKKwltdXRleF91bmxvY2soJmRydl9kYXRhLT5tdXRleCk7
CiAJcmV0dXJuIHJldDsKIH0KIAogc3RhdGljIGludCBkczEzNzRfc2V0X2FsYXJtKHN0cnVjdCBk
ZXZpY2UgKmRldiwgc3RydWN0IHJ0Y193a2Fscm0gKmFsYXJtKQogewotCXN0cnVjdCBpMmNfY2xp
ZW50ICpjbGllbnQgPSB0b19pMmNfY2xpZW50KGRldik7Ci0Jc3RydWN0IGRzMTM3NCAqZHMxMzc0
ID0gaTJjX2dldF9jbGllbnRkYXRhKGNsaWVudCk7CisJc3RydWN0IGkyY19jbGllbnQgKmNsaWVu
dCA9IHRvX2kyY19jbGllbnQoZGV2LT5wYXJlbnQpOworCXN0cnVjdCBkczEzNzRfcnRjICpkcnZf
ZGF0YSA9IGRldi0+ZHJpdmVyX2RhdGE7CiAJc3RydWN0IHJ0Y190aW1lIG5vdzsKIAl1bnNpZ25l
ZCBsb25nIG5ld19hbGFybSwgaXRpbWU7CiAJaW50IGNyOwpAQCAtMjUwLDcgKzIyNiw3IEBAIHN0
YXRpYyBpbnQgZHMxMzc0X3NldF9hbGFybShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBydGNf
d2thbHJtICphbGFybSkKIAllbHNlCiAJCW5ld19hbGFybSAtPSBpdGltZTsKIAotCW11dGV4X2xv
Y2soJmRzMTM3NC0+bXV0ZXgpOworCW11dGV4X2xvY2soJmRydl9kYXRhLT5tdXRleCk7CiAKIAly
ZXQgPSBjciA9IGkyY19zbWJ1c19yZWFkX2J5dGVfZGF0YShjbGllbnQsIERTMTM3NF9SRUdfQ1Ip
OwogCWlmIChyZXQgPCAwKQpAQCAtMjc2LDI4ICsyNTIsMjkgQEAgc3RhdGljIGludCBkczEzNzRf
c2V0X2FsYXJtKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IHJ0Y193a2Fscm0gKmFsYXJtKQog
CX0KIAogb3V0OgotCW11dGV4X3VubG9jaygmZHMxMzc0LT5tdXRleCk7CisJbXV0ZXhfdW5sb2Nr
KCZkcnZfZGF0YS0+bXV0ZXgpOwogCXJldHVybiByZXQ7CiB9CiAjZW5kaWYKIAogc3RhdGljIGly
cXJldHVybl90IGRzMTM3NF9pcnEoaW50IGlycSwgdm9pZCAqZGV2X2lkKQogewotCXN0cnVjdCBp
MmNfY2xpZW50ICpjbGllbnQgPSBkZXZfaWQ7Ci0Jc3RydWN0IGRzMTM3NCAqZHMxMzc0ID0gaTJj
X2dldF9jbGllbnRkYXRhKGNsaWVudCk7CisJc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldiA9
IGRldl9pZDsKKwlzdHJ1Y3QgZHMxMzc0X3J0YyAqZHJ2X2RhdGEgPSBwbGF0Zm9ybV9nZXRfZHJ2
ZGF0YShwZGV2KTsKIAogCWRpc2FibGVfaXJxX25vc3luYyhpcnEpOwotCXNjaGVkdWxlX3dvcmso
JmRzMTM3NC0+d29yayk7CisJc2NoZWR1bGVfd29yaygmZHJ2X2RhdGEtPndvcmspOwogCXJldHVy
biBJUlFfSEFORExFRDsKIH0KIAogc3RhdGljIHZvaWQgZHMxMzc0X3dvcmsoc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKQogewotCXN0cnVjdCBkczEzNzQgKmRzMTM3NCA9IGNvbnRhaW5lcl9vZih3
b3JrLCBzdHJ1Y3QgZHMxMzc0LCB3b3JrKTsKLQlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0g
ZHMxMzc0LT5jbGllbnQ7CisJc3RydWN0IGRzMTM3NF9ydGMgKmRydl9kYXRhID0gY29udGFpbmVy
X29mKHdvcmssCisJCQkJCQlzdHJ1Y3QgZHMxMzc0X3J0Yywgd29yayk7CisJc3RydWN0IGkyY19j
bGllbnQgKmNsaWVudCA9IGRydl9kYXRhLT5jbGllbnQ7CiAJaW50IHN0YXQsIGNvbnRyb2w7CiAK
LQltdXRleF9sb2NrKCZkczEzNzQtPm11dGV4KTsKKwltdXRleF9sb2NrKCZkcnZfZGF0YS0+bXV0
ZXgpOwogCiAJc3RhdCA9IGkyY19zbWJ1c19yZWFkX2J5dGVfZGF0YShjbGllbnQsIERTMTM3NF9S
RUdfU1IpOwogCWlmIChzdGF0IDwgMCkKQEAgLTMxNCwyNCArMjkxLDI0IEBAIHN0YXRpYyB2b2lk
IGRzMTM3NF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIAkJY29udHJvbCAmPSB+KERT
MTM3NF9SRUdfQ1JfV0FDRSB8IERTMTM3NF9SRUdfQ1JfQUlFKTsKIAkJaTJjX3NtYnVzX3dyaXRl
X2J5dGVfZGF0YShjbGllbnQsIERTMTM3NF9SRUdfQ1IsIGNvbnRyb2wpOwogCi0JCXJ0Y191cGRh
dGVfaXJxKGRzMTM3NC0+cnRjLCAxLCBSVENfQUYgfCBSVENfSVJRRik7CisJCXJ0Y191cGRhdGVf
aXJxKGRydl9kYXRhLT5ydGMsIDEsIFJUQ19BRiB8IFJUQ19JUlFGKTsKIAl9CiAKIG91dDoKLQlp
ZiAoIWRzMTM3NC0+ZXhpdGluZykKKwlpZiAoIWRydl9kYXRhLT5leGl0aW5nKQogCQllbmFibGVf
aXJxKGNsaWVudC0+aXJxKTsKIHVubG9jazoKLQltdXRleF91bmxvY2soJmRzMTM3NC0+bXV0ZXgp
OworCW11dGV4X3VubG9jaygmZHJ2X2RhdGEtPm11dGV4KTsKIH0KIAotI2lmbmRlZiBDT05GSUdf
UlRDX0RSVl9EUzEzNzRfV0RUCisjaWZuZGVmIENPTkZJR19EUzEzNzRfV0FUQ0hET0cKIHN0YXRp
YyBpbnQgZHMxMzc0X2FsYXJtX2lycV9lbmFibGUoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25l
ZCBpbnQgZW5hYmxlZCkKIHsKLQlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0gdG9faTJjX2Ns
aWVudChkZXYpOwotCXN0cnVjdCBkczEzNzQgKmRzMTM3NCA9IGkyY19nZXRfY2xpZW50ZGF0YShj
bGllbnQpOworCXN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQgPSB0b19pMmNfY2xpZW50KGRldi0+
cGFyZW50KTsKKwlzdHJ1Y3QgZHMxMzc0X3J0YyAqZHJ2X2RhdGEgPSBkZXYtPmRyaXZlcl9kYXRh
OwogCWludCByZXQ7CiAKLQltdXRleF9sb2NrKCZkczEzNzQtPm11dGV4KTsKKwltdXRleF9sb2Nr
KCZkcnZfZGF0YS0+bXV0ZXgpOwogCiAJcmV0ID0gaTJjX3NtYnVzX3JlYWRfYnl0ZV9kYXRhKGNs
aWVudCwgRFMxMzc0X1JFR19DUik7CiAJaWYgKHJldCA8IDApCkBAIC0zNDYsMzgzICszMjMsOTYg
QEAgc3RhdGljIGludCBkczEzNzRfYWxhcm1faXJxX2VuYWJsZShzdHJ1Y3QgZGV2aWNlICpkZXYs
IHVuc2lnbmVkIGludCBlbmFibGVkKQogCXJldCA9IGkyY19zbWJ1c193cml0ZV9ieXRlX2RhdGEo
Y2xpZW50LCBEUzEzNzRfUkVHX0NSLCByZXQpOwogCiBvdXQ6Ci0JbXV0ZXhfdW5sb2NrKCZkczEz
NzQtPm11dGV4KTsKKwltdXRleF91bmxvY2soJmRydl9kYXRhLT5tdXRleCk7CiAJcmV0dXJuIHJl
dDsKIH0KICNlbmRpZgogCiBzdGF0aWMgY29uc3Qgc3RydWN0IHJ0Y19jbGFzc19vcHMgZHMxMzc0
X3J0Y19vcHMgPSB7Ci0JLnJlYWRfdGltZSA9IGRzMTM3NF9yZWFkX3RpbWUsCi0JLnNldF90aW1l
ID0gZHMxMzc0X3NldF90aW1lLAotI2lmbmRlZiBDT05GSUdfUlRDX0RSVl9EUzEzNzRfV0RUCi0J
LnJlYWRfYWxhcm0gPSBkczEzNzRfcmVhZF9hbGFybSwKLQkuc2V0X2FsYXJtID0gZHMxMzc0X3Nl
dF9hbGFybSwKKwkucmVhZF90aW1lICAgICAgICA9IGRzMTM3NF9yZWFkX3RpbWUsCisJLnNldF90
aW1lICAgICAgICAgPSBkczEzNzRfc2V0X3RpbWUsCisjaWZuZGVmIENPTkZJR19EUzEzNzRfV0FU
Q0hET0cKKwkucmVhZF9hbGFybSAgICAgICA9IGRzMTM3NF9yZWFkX2FsYXJtLAorCS5zZXRfYWxh
cm0gICAgICAgID0gZHMxMzc0X3NldF9hbGFybSwKIAkuYWxhcm1faXJxX2VuYWJsZSA9IGRzMTM3
NF9hbGFybV9pcnFfZW5hYmxlLAogI2VuZGlmCiB9OwogCi0jaWZkZWYgQ09ORklHX1JUQ19EUlZf
RFMxMzc0X1dEVAotLyoKLSAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICoKLSAqIFdhdGNoZG9nIERy
aXZlcgotICoKLSAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICovCi1zdGF0aWMgc3RydWN0IGkyY19j
bGllbnQgKnNhdmVfY2xpZW50OwotLyogRGVmYXVsdCBtYXJnaW4gKi8KLSNkZWZpbmUgV0RfVElN
TyAxMzE3NjIKLQotI2RlZmluZSBEUlZfTkFNRSAiRFMxMzc0IFdhdGNoZG9nIgotCi1zdGF0aWMg
aW50IHdkdF9tYXJnaW4gPSBXRF9USU1POwotc3RhdGljIHVuc2lnbmVkIGxvbmcgd2R0X2lzX29w
ZW47Ci1tb2R1bGVfcGFyYW0od2R0X21hcmdpbiwgaW50LCAwKTsKLU1PRFVMRV9QQVJNX0RFU0Mo
d2R0X21hcmdpbiwgIldhdGNoZG9nIHRpbWVvdXQgaW4gc2Vjb25kcyAoZGVmYXVsdCAzMnMpIik7
Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qgd2F0Y2hkb2dfaW5mbyBkczEzNzRfd2R0X2luZm8gPSB7
Ci0JLmlkZW50aXR5ICAgICAgID0gIkRTMTM3NCBXVEQiLAotCS5vcHRpb25zICAgICAgICA9IFdE
SU9GX1NFVFRJTUVPVVQgfCBXRElPRl9LRUVQQUxJVkVQSU5HIHwKLQkJCQkJCVdESU9GX01BR0lD
Q0xPU0UsCi19OwotCi1zdGF0aWMgaW50IGRzMTM3NF93ZHRfc2V0dGltZW91dCh1bnNpZ25lZCBp
bnQgdGltZW91dCkKK3N0YXRpYyBpbnQgZHMxMzc0X3J0Y19wcm9iZShzdHJ1Y3QgcGxhdGZvcm1f
ZGV2aWNlICpwZGV2KQogewotCWludCByZXQgPSAtRU5PSU9DVExDTUQ7Ci0JaW50IGNyOwotCi0J
cmV0ID0gY3IgPSBpMmNfc21idXNfcmVhZF9ieXRlX2RhdGEoc2F2ZV9jbGllbnQsIERTMTM3NF9S
RUdfQ1IpOwotCWlmIChyZXQgPCAwKQotCQlnb3RvIG91dDsKLQotCS8qIERpc2FibGUgYW55IGV4
aXN0aW5nIHdhdGNoZG9nL2FsYXJtIGJlZm9yZSBzZXR0aW5nIHRoZSBuZXcgb25lICovCi0JY3Ig
Jj0gfkRTMTM3NF9SRUdfQ1JfV0FDRTsKLQotCXJldCA9IGkyY19zbWJ1c193cml0ZV9ieXRlX2Rh
dGEoc2F2ZV9jbGllbnQsIERTMTM3NF9SRUdfQ1IsIGNyKTsKLQlpZiAocmV0IDwgMCkKLQkJZ290
byBvdXQ7Ci0KLQkvKiBTZXQgbmV3IHdhdGNoZG9nIHRpbWUgKi8KLQlyZXQgPSBkczEzNzRfd3Jp
dGVfcnRjKHNhdmVfY2xpZW50LCB0aW1lb3V0LCBEUzEzNzRfUkVHX1dEQUxNMCwgMyk7Ci0JaWYg
KHJldCkgewotCQlwcl9pbmZvKCJjb3VsZG4ndCBzZXQgbmV3IHdhdGNoZG9nIHRpbWVcbiIpOwot
CQlnb3RvIG91dDsKLQl9Ci0KLQkvKiBFbmFibGUgd2F0Y2hkb2cgdGltZXIgKi8KLQljciB8PSBE
UzEzNzRfUkVHX0NSX1dBQ0UgfCBEUzEzNzRfUkVHX0NSX1dEQUxNOwotCWNyICY9IH5EUzEzNzRf
UkVHX0NSX0FJRTsKLQotCXJldCA9IGkyY19zbWJ1c193cml0ZV9ieXRlX2RhdGEoc2F2ZV9jbGll
bnQsIERTMTM3NF9SRUdfQ1IsIGNyKTsKLQlpZiAocmV0IDwgMCkKLQkJZ290byBvdXQ7Ci0KLQly
ZXR1cm4gMDsKLW91dDoKLQlyZXR1cm4gcmV0OwotfQotCi0KLS8qCi0gKiBSZWxvYWQgdGhlIHdh
dGNoZG9nIHRpbWVyLiAgKGllLCBwYXQgdGhlIHdhdGNoZG9nKQotICovCi1zdGF0aWMgdm9pZCBk
czEzNzRfd2R0X3Bpbmcodm9pZCkKLXsKLQl1MzIgdmFsOwotCWludCByZXQgPSAwOwotCi0JcmV0
ID0gZHMxMzc0X3JlYWRfcnRjKHNhdmVfY2xpZW50LCAmdmFsLCBEUzEzNzRfUkVHX1dEQUxNMCwg
Myk7Ci0JaWYgKHJldCkKLQkJcHJfaW5mbygiV0QgVElDSyBGQUlMISEhISEhISEhISAlaVxuIiwg
cmV0KTsKLX0KLQotc3RhdGljIHZvaWQgZHMxMzc0X3dkdF9kaXNhYmxlKHZvaWQpCi17Ci0JaW50
IGNyOwotCi0JY3IgPSBpMmNfc21idXNfcmVhZF9ieXRlX2RhdGEoc2F2ZV9jbGllbnQsIERTMTM3
NF9SRUdfQ1IpOwotCS8qIERpc2FibGUgd2F0Y2hkb2cgdGltZXIgKi8KLQljciAmPSB+RFMxMzc0
X1JFR19DUl9XQUNFOwotCi0JaTJjX3NtYnVzX3dyaXRlX2J5dGVfZGF0YShzYXZlX2NsaWVudCwg
RFMxMzc0X1JFR19DUiwgY3IpOwotfQotCi0vKgotICogV2F0Y2hkb2cgZGV2aWNlIGlzIG9wZW5l
ZCwgYW5kIHdhdGNoZG9nIHN0YXJ0cyBydW5uaW5nLgotICovCi1zdGF0aWMgaW50IGRzMTM3NF93
ZHRfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKLXsKLQlzdHJ1
Y3QgZHMxMzc0ICpkczEzNzQgPSBpMmNfZ2V0X2NsaWVudGRhdGEoc2F2ZV9jbGllbnQpOwotCi0J
aWYgKE1JTk9SKGlub2RlLT5pX3JkZXYpID09IFdBVENIRE9HX01JTk9SKSB7Ci0JCW11dGV4X2xv
Y2soJmRzMTM3NC0+bXV0ZXgpOwotCQlpZiAodGVzdF9hbmRfc2V0X2JpdCgwLCAmd2R0X2lzX29w
ZW4pKSB7Ci0JCQltdXRleF91bmxvY2soJmRzMTM3NC0+bXV0ZXgpOwotCQkJcmV0dXJuIC1FQlVT
WTsKLQkJfQotCQkvKgotCQkgKiAgICAgIEFjdGl2YXRlCi0JCSAqLwotCQl3ZHRfaXNfb3BlbiA9
IDE7Ci0JCW11dGV4X3VubG9jaygmZHMxMzc0LT5tdXRleCk7Ci0JCXJldHVybiBzdHJlYW1fb3Bl
bihpbm9kZSwgZmlsZSk7Ci0JfQotCXJldHVybiAtRU5PREVWOwotfQotCi0vKgotICogQ2xvc2Ug
dGhlIHdhdGNoZG9nIGRldmljZS4KLSAqLwotc3RhdGljIGludCBkczEzNzRfd2R0X3JlbGVhc2Uo
c3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCi17Ci0JaWYgKE1JTk9SKGlu
b2RlLT5pX3JkZXYpID09IFdBVENIRE9HX01JTk9SKQotCQljbGVhcl9iaXQoMCwgJndkdF9pc19v
cGVuKTsKLQotCXJldHVybiAwOwotfQotCi0vKgotICogUGF0IHRoZSB3YXRjaGRvZyB3aGVuZXZl
ciBkZXZpY2UgaXMgd3JpdHRlbiB0by4KLSAqLwotc3RhdGljIHNzaXplX3QgZHMxMzc0X3dkdF93
cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwgY29uc3QgY2hhciBfX3VzZXIgKmRhdGEsCi0JCQkJc2l6
ZV90IGxlbiwgbG9mZl90ICpwcG9zKQotewotCWlmIChsZW4pIHsKLQkJZHMxMzc0X3dkdF9waW5n
KCk7Ci0JCXJldHVybiAxOwotCX0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHNzaXplX3QgZHMx
Mzc0X3dkdF9yZWFkKHN0cnVjdCBmaWxlICpmaWxlLCBjaGFyIF9fdXNlciAqZGF0YSwKLQkJCQlz
aXplX3QgbGVuLCBsb2ZmX3QgKnBwb3MpCi17Ci0JcmV0dXJuIDA7Ci19Ci0KLS8qCi0gKiBIYW5k
bGUgY29tbWFuZHMgZnJvbSB1c2VyLXNwYWNlLgotICovCi1zdGF0aWMgbG9uZyBkczEzNzRfd2R0
X2lvY3RsKHN0cnVjdCBmaWxlICpmaWxlLCB1bnNpZ25lZCBpbnQgY21kLAotCQkJCQkJCXVuc2ln
bmVkIGxvbmcgYXJnKQotewotCWludCBuZXdfbWFyZ2luLCBvcHRpb25zOwotCi0Jc3dpdGNoIChj
bWQpIHsKLQljYXNlIFdESU9DX0dFVFNVUFBPUlQ6Ci0JCXJldHVybiBjb3B5X3RvX3VzZXIoKHN0
cnVjdCB3YXRjaGRvZ19pbmZvIF9fdXNlciAqKWFyZywKLQkJJmRzMTM3NF93ZHRfaW5mbywgc2l6
ZW9mKGRzMTM3NF93ZHRfaW5mbykpID8gLUVGQVVMVCA6IDA7Ci0KLQljYXNlIFdESU9DX0dFVFNU
QVRVUzoKLQljYXNlIFdESU9DX0dFVEJPT1RTVEFUVVM6Ci0JCXJldHVybiBwdXRfdXNlcigwLCAo
aW50IF9fdXNlciAqKWFyZyk7Ci0JY2FzZSBXRElPQ19LRUVQQUxJVkU6Ci0JCWRzMTM3NF93ZHRf
cGluZygpOwotCQlyZXR1cm4gMDsKLQljYXNlIFdESU9DX1NFVFRJTUVPVVQ6Ci0JCWlmIChnZXRf
dXNlcihuZXdfbWFyZ2luLCAoaW50IF9fdXNlciAqKWFyZykpCi0JCQlyZXR1cm4gLUVGQVVMVDsK
LQotCQkvKiB0aGUgaGFyZHdhcmUncyB0aWNrIHJhdGUgaXMgNDA5NiBIeiwgc28KLQkJICogdGhl
IGNvdW50ZXIgdmFsdWUgbmVlZHMgdG8gYmUgc2NhbGVkIGFjY29yZGluZ2x5Ci0JCSAqLwotCQlu
ZXdfbWFyZ2luIDw8PSAxMjsKLQkJaWYgKG5ld19tYXJnaW4gPCAxIHx8IG5ld19tYXJnaW4gPiAx
Njc3NzIxNikKLQkJCXJldHVybiAtRUlOVkFMOwotCi0JCXdkdF9tYXJnaW4gPSBuZXdfbWFyZ2lu
OwotCQlkczEzNzRfd2R0X3NldHRpbWVvdXQobmV3X21hcmdpbik7Ci0JCWRzMTM3NF93ZHRfcGlu
ZygpOwotCQkvKiBmYWxsdGhyb3VnaCAqLwotCWNhc2UgV0RJT0NfR0VUVElNRU9VVDoKLQkJLyog
d2hlbiByZXR1cm5pbmcgLi4uIGludmVyc2UgaXMgdHJ1ZSAqLwotCQlyZXR1cm4gcHV0X3VzZXIo
KHdkdF9tYXJnaW4gPj4gMTIpLCAoaW50IF9fdXNlciAqKWFyZyk7Ci0JY2FzZSBXRElPQ19TRVRP
UFRJT05TOgotCQlpZiAoY29weV9mcm9tX3VzZXIoJm9wdGlvbnMsIChpbnQgX191c2VyICopYXJn
LCBzaXplb2YoaW50KSkpCi0JCQlyZXR1cm4gLUVGQVVMVDsKLQotCQlpZiAob3B0aW9ucyAmIFdE
SU9TX0RJU0FCTEVDQVJEKSB7Ci0JCQlwcl9pbmZvKCJkaXNhYmxlIHdhdGNoZG9nXG4iKTsKLQkJ
CWRzMTM3NF93ZHRfZGlzYWJsZSgpOwotCQkJcmV0dXJuIDA7Ci0JCX0KLQotCQlpZiAob3B0aW9u
cyAmIFdESU9TX0VOQUJMRUNBUkQpIHsKLQkJCXByX2luZm8oImVuYWJsZSB3YXRjaGRvZ1xuIik7
Ci0JCQlkczEzNzRfd2R0X3NldHRpbWVvdXQod2R0X21hcmdpbik7Ci0JCQlkczEzNzRfd2R0X3Bp
bmcoKTsKLQkJCXJldHVybiAwOwotCQl9Ci0JCXJldHVybiAtRUlOVkFMOwotCX0KLQlyZXR1cm4g
LUVOT1RUWTsKLX0KLQotc3RhdGljIGxvbmcgZHMxMzc0X3dkdF91bmxvY2tlZF9pb2N0bChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdW5zaWduZWQgaW50IGNtZCwKLQkJCXVuc2lnbmVkIGxvbmcgYXJnKQot
ewotCWludCByZXQ7Ci0Jc3RydWN0IGRzMTM3NCAqZHMxMzc0ID0gaTJjX2dldF9jbGllbnRkYXRh
KHNhdmVfY2xpZW50KTsKLQotCW11dGV4X2xvY2soJmRzMTM3NC0+bXV0ZXgpOwotCXJldCA9IGRz
MTM3NF93ZHRfaW9jdGwoZmlsZSwgY21kLCBhcmcpOwotCW11dGV4X3VubG9jaygmZHMxMzc0LT5t
dXRleCk7Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgaW50IGRzMTM3NF93ZHRfbm90aWZ5
X3N5cyhzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKnRoaXMsCi0JCQl1bnNpZ25lZCBsb25nIGNvZGUs
IHZvaWQgKnVudXNlZCkKLXsKLQlpZiAoY29kZSA9PSBTWVNfRE9XTiB8fCBjb2RlID09IFNZU19I
QUxUKQotCQkvKiBEaXNhYmxlIFdhdGNoZG9nICovCi0JCWRzMTM3NF93ZHRfZGlzYWJsZSgpOwot
CXJldHVybiBOT1RJRllfRE9ORTsKLX0KLQotc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJh
dGlvbnMgZHMxMzc0X3dkdF9mb3BzID0gewotCS5vd25lcgkJCT0gVEhJU19NT0RVTEUsCi0JLnJl
YWQJCQk9IGRzMTM3NF93ZHRfcmVhZCwKLQkudW5sb2NrZWRfaW9jdGwJCT0gZHMxMzc0X3dkdF91
bmxvY2tlZF9pb2N0bCwKLQkuY29tcGF0X2lvY3RsCQk9IGNvbXBhdF9wdHJfaW9jdGwsCi0JLndy
aXRlCQkJPSBkczEzNzRfd2R0X3dyaXRlLAotCS5vcGVuICAgICAgICAgICAgICAgICAgID0gZHMx
Mzc0X3dkdF9vcGVuLAotCS5yZWxlYXNlICAgICAgICAgICAgICAgID0gZHMxMzc0X3dkdF9yZWxl
YXNlLAotCS5sbHNlZWsJCQk9IG5vX2xsc2VlaywKLX07Ci0KLXN0YXRpYyBzdHJ1Y3QgbWlzY2Rl
dmljZSBkczEzNzRfbWlzY2RldiA9IHsKLQkubWlub3IgICAgICAgICAgPSBXQVRDSERPR19NSU5P
UiwKLQkubmFtZSAgICAgICAgICAgPSAid2F0Y2hkb2ciLAotCS5mb3BzICAgICAgICAgICA9ICZk
czEzNzRfd2R0X2ZvcHMsCi19OwotCi1zdGF0aWMgc3RydWN0IG5vdGlmaWVyX2Jsb2NrIGRzMTM3
NF93ZHRfbm90aWZpZXIgPSB7Ci0JLm5vdGlmaWVyX2NhbGwgPSBkczEzNzRfd2R0X25vdGlmeV9z
eXMsCi19OwotCi0jZW5kaWYgLypDT05GSUdfUlRDX0RSVl9EUzEzNzRfV0RUKi8KLS8qCi0gKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioKLSAqCi0gKglEcml2ZXIgSW50ZXJmYWNlCi0gKgotICoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqCi0gKi8KLXN0YXRpYyBpbnQgZHMxMzc0X3Byb2JlKHN0cnVjdCBpMmNfY2xp
ZW50ICpjbGllbnQsCi0JCQljb25zdCBzdHJ1Y3QgaTJjX2RldmljZV9pZCAqaWQpCi17Ci0Jc3Ry
dWN0IGRzMTM3NCAqZHMxMzc0OworCXN0cnVjdCBkczEzNzRfcnRjICpkcnZfZGF0YTsKKwlzdHJ1
Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0gdG9faTJjX2NsaWVudChwZGV2LT5kZXYucGFyZW50KTsK
IAlpbnQgcmV0OwogCi0JZHMxMzc0ID0gZGV2bV9remFsbG9jKCZjbGllbnQtPmRldiwgc2l6ZW9m
KHN0cnVjdCBkczEzNzQpLCBHRlBfS0VSTkVMKTsKLQlpZiAoIWRzMTM3NCkKKwlkcnZfZGF0YSA9
IGRldm1fa3phbGxvYygmcGRldi0+ZGV2LCBzaXplb2Yoc3RydWN0IGRzMTM3NF9ydGMpLAorCQkJ
CUdGUF9LRVJORUwpOworCWlmICghZHJ2X2RhdGEpCiAJCXJldHVybiAtRU5PTUVNOwogCi0JZHMx
Mzc0LT5ydGMgPSBkZXZtX3J0Y19hbGxvY2F0ZV9kZXZpY2UoJmNsaWVudC0+ZGV2KTsKLQlpZiAo
SVNfRVJSKGRzMTM3NC0+cnRjKSkKLQkJcmV0dXJuIFBUUl9FUlIoZHMxMzc0LT5ydGMpOworCWRy
dl9kYXRhLT5ydGMgPSBkZXZtX3J0Y19hbGxvY2F0ZV9kZXZpY2UoJnBkZXYtPmRldik7CisJaWYg
KElTX0VSUihkcnZfZGF0YS0+cnRjKSkKKwkJcmV0dXJuIFBUUl9FUlIoZHJ2X2RhdGEtPnJ0Yyk7
CiAKLQlkczEzNzQtPmNsaWVudCA9IGNsaWVudDsKLQlpMmNfc2V0X2NsaWVudGRhdGEoY2xpZW50
LCBkczEzNzQpOworCWRydl9kYXRhLT5jbGllbnQgPSBjbGllbnQ7CiAKLQlJTklUX1dPUksoJmRz
MTM3NC0+d29yaywgZHMxMzc0X3dvcmspOwotCW11dGV4X2luaXQoJmRzMTM3NC0+bXV0ZXgpOwor
CUlOSVRfV09SSygmZHJ2X2RhdGEtPndvcmssIGRzMTM3NF93b3JrKTsKKwltdXRleF9pbml0KCZk
cnZfZGF0YS0+bXV0ZXgpOwogCiAJcmV0ID0gZHMxMzc0X2NoZWNrX3J0Y19zdGF0dXMoY2xpZW50
KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCiAJaWYgKGNsaWVudC0+aXJxID4gMCkgewot
CQlyZXQgPSBkZXZtX3JlcXVlc3RfaXJxKCZjbGllbnQtPmRldiwgY2xpZW50LT5pcnEsIGRzMTM3
NF9pcnEsIDAsCi0JCQkJCSJkczEzNzQiLCBjbGllbnQpOworCQlyZXQgPSBkZXZtX3JlcXVlc3Rf
aXJxKCZwZGV2LT5kZXYsIGNsaWVudC0+aXJxLCBkczEzNzRfaXJxLCAwLAorCQkJCQkiZHMxMzc0
X3J0YyIsIHBkZXYpOwogCQlpZiAocmV0KSB7Ci0JCQlkZXZfZXJyKCZjbGllbnQtPmRldiwgInVu
YWJsZSB0byByZXF1ZXN0IElSUVxuIik7CisJCQlkZXZfZXJyKCZwZGV2LT5kZXYsICJ1bmFibGUg
dG8gcmVxdWVzdCBJUlFcbiIpOwogCQkJcmV0dXJuIHJldDsKIAkJfQogCi0JCWRldmljZV9zZXRf
d2FrZXVwX2NhcGFibGUoJmNsaWVudC0+ZGV2LCAxKTsKKwkJZGV2aWNlX3NldF93YWtldXBfY2Fw
YWJsZSgmcGRldi0+ZGV2LCAxKTsKIAl9CiAKLQlkczEzNzQtPnJ0Yy0+b3BzID0gJmRzMTM3NF9y
dGNfb3BzOwotCWRzMTM3NC0+cnRjLT5yYW5nZV9tYXggPSBVMzJfTUFYOworCWRydl9kYXRhLT5y
dGMtPm9wcyA9ICZkczEzNzRfcnRjX29wczsKKwlkcnZfZGF0YS0+cnRjLT5yYW5nZV9tYXggPSBV
MzJfTUFYOworCXBsYXRmb3JtX3NldF9kcnZkYXRhKHBkZXYsIGRydl9kYXRhKTsKIAotCXJldCA9
IHJ0Y19yZWdpc3Rlcl9kZXZpY2UoZHMxMzc0LT5ydGMpOworCXJldCA9IHJ0Y19yZWdpc3Rlcl9k
ZXZpY2UoZHJ2X2RhdGEtPnJ0Yyk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAotI2lmZGVm
IENPTkZJR19SVENfRFJWX0RTMTM3NF9XRFQKLQlzYXZlX2NsaWVudCA9IGNsaWVudDsKLQlyZXQg
PSBtaXNjX3JlZ2lzdGVyKCZkczEzNzRfbWlzY2Rldik7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJl
dDsKLQlyZXQgPSByZWdpc3Rlcl9yZWJvb3Rfbm90aWZpZXIoJmRzMTM3NF93ZHRfbm90aWZpZXIp
OwotCWlmIChyZXQpIHsKLQkJbWlzY19kZXJlZ2lzdGVyKCZkczEzNzRfbWlzY2Rldik7Ci0JCXJl
dHVybiByZXQ7Ci0JfQotCWRzMTM3NF93ZHRfc2V0dGltZW91dCgxMzEwNzIpOwotI2VuZGlmCi0K
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBkczEzNzRfcmVtb3ZlKHN0cnVjdCBpMmNfY2xp
ZW50ICpjbGllbnQpCitzdGF0aWMgaW50IGRzMTM3NF9ydGNfcmVtb3ZlKHN0cnVjdCBwbGF0Zm9y
bV9kZXZpY2UgKnBkZXYpCiB7Ci0Jc3RydWN0IGRzMTM3NCAqZHMxMzc0ID0gaTJjX2dldF9jbGll
bnRkYXRhKGNsaWVudCk7Ci0jaWZkZWYgQ09ORklHX1JUQ19EUlZfRFMxMzc0X1dEVAotCW1pc2Nf
ZGVyZWdpc3RlcigmZHMxMzc0X21pc2NkZXYpOwotCWRzMTM3NF9taXNjZGV2LnBhcmVudCA9IE5V
TEw7Ci0JdW5yZWdpc3Rlcl9yZWJvb3Rfbm90aWZpZXIoJmRzMTM3NF93ZHRfbm90aWZpZXIpOwot
I2VuZGlmCisJc3RydWN0IGRzMTM3NF9ydGMgKmRydl9kYXRhID0gcGxhdGZvcm1fZ2V0X2RydmRh
dGEocGRldik7CisJc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCA9IHRvX2kyY19jbGllbnQocGRl
di0+ZGV2LnBhcmVudCk7CiAKIAlpZiAoY2xpZW50LT5pcnEgPiAwKSB7Ci0JCW11dGV4X2xvY2so
JmRzMTM3NC0+bXV0ZXgpOwotCQlkczEzNzQtPmV4aXRpbmcgPSAxOwotCQltdXRleF91bmxvY2so
JmRzMTM3NC0+bXV0ZXgpOworCQltdXRleF9sb2NrKCZkcnZfZGF0YS0+bXV0ZXgpOworCQlkcnZf
ZGF0YS0+ZXhpdGluZyA9IDE7CisJCW11dGV4X3VubG9jaygmZHJ2X2RhdGEtPm11dGV4KTsKIAog
CQlkZXZtX2ZyZWVfaXJxKCZjbGllbnQtPmRldiwgY2xpZW50LT5pcnEsIGNsaWVudCk7Ci0JCWNh
bmNlbF93b3JrX3N5bmMoJmRzMTM3NC0+d29yayk7CisJCWNhbmNlbF93b3JrX3N5bmMoJmRydl9k
YXRhLT53b3JrKTsKIAl9CiAKIAlyZXR1cm4gMDsKIH0KIAotI2lmZGVmIENPTkZJR19QTV9TTEVF
UAotc3RhdGljIGludCBkczEzNzRfc3VzcGVuZChzdHJ1Y3QgZGV2aWNlICpkZXYpCi17Ci0Jc3Ry
dWN0IGkyY19jbGllbnQgKmNsaWVudCA9IHRvX2kyY19jbGllbnQoZGV2KTsKLQotCWlmIChjbGll
bnQtPmlycSA+IDAgJiYgZGV2aWNlX21heV93YWtldXAoJmNsaWVudC0+ZGV2KSkKLQkJZW5hYmxl
X2lycV93YWtlKGNsaWVudC0+aXJxKTsKLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBkczEz
NzRfcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikKLXsKLQlzdHJ1Y3QgaTJjX2NsaWVudCAqY2xp
ZW50ID0gdG9faTJjX2NsaWVudChkZXYpOwotCi0JaWYgKGNsaWVudC0+aXJxID4gMCAmJiBkZXZp
Y2VfbWF5X3dha2V1cCgmY2xpZW50LT5kZXYpKQotCQlkaXNhYmxlX2lycV93YWtlKGNsaWVudC0+
aXJxKTsKLQlyZXR1cm4gMDsKLX0KLSNlbmRpZgotCi1zdGF0aWMgU0lNUExFX0RFVl9QTV9PUFMo
ZHMxMzc0X3BtLCBkczEzNzRfc3VzcGVuZCwgZHMxMzc0X3Jlc3VtZSk7Ci0KLXN0YXRpYyBzdHJ1
Y3QgaTJjX2RyaXZlciBkczEzNzRfZHJpdmVyID0gewotCS5kcml2ZXIgPSB7Ci0JCS5uYW1lID0g
InJ0Yy1kczEzNzQiLAotCQkub2ZfbWF0Y2hfdGFibGUgPSBvZl9tYXRjaF9wdHIoZHMxMzc0X29m
X21hdGNoKSwKLQkJLnBtID0gJmRzMTM3NF9wbSwKK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZHJp
dmVyIGRzMTM3NF9ydGMgPSB7CisJLmRyaXZlcgkgICAgICAgPSB7CisJCS5vd25lciA9IFRISVNf
TU9EVUxFLAorCQkubmFtZSAgPSBERVZOQU1FLAogCX0sCi0JLnByb2JlID0gZHMxMzc0X3Byb2Jl
LAotCS5yZW1vdmUgPSBkczEzNzRfcmVtb3ZlLAotCS5pZF90YWJsZSA9IGRzMTM3NF9pZCwKKwku
cHJvYmUgICAgICAgICA9IGRzMTM3NF9ydGNfcHJvYmUsCisJLnJlbW92ZSAgICAgICAgPSBkczEz
NzRfcnRjX3JlbW92ZSwKIH07CiAKLW1vZHVsZV9pMmNfZHJpdmVyKGRzMTM3NF9kcml2ZXIpOwor
bW9kdWxlX3BsYXRmb3JtX2RyaXZlcihkczEzNzRfcnRjKTsKIAogTU9EVUxFX0FVVEhPUigiU2Nv
dHQgV29vZCA8c2NvdHR3b29kQGZyZWVzY2FsZS5jb20+Iik7CiBNT0RVTEVfREVTQ1JJUFRJT04o
Ik1heGltL0RhbGxhcyBEUzEzNzQgUlRDIERyaXZlciIpOwogTU9EVUxFX0xJQ0VOU0UoIkdQTCIp
OworTU9EVUxFX0FMSUFTKCJQbGF0Zm9ybTpkczEzNzRfcnRjIik7Ci0tIAoyLjIwLjEK
